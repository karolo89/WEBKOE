"0","Optimal_Clusters_KMeans <- function(data, max_clusters, plot_clusters = TRUE, criterion = 'WCSSE') {"
"0","  set.seed(123)"
"0","  "
"0","  # Function to calculate the total within-cluster sum of squares error (WCSSE)"
"0","  calculate_wcsse <- function(k) {"
"0","    kmeans_result <- kmeans(data, k)"
"0","    return(kmeans_result$tot.withinss)"
"0","  }"
"0","  "
"0","  # Calculate the WCSSE for each number of clusters"
"0","  wcsse_values <- sapply(1:max_clusters, calculate_wcsse)"
"0","  "
"0","  if (plot_clusters) {"
"0","    # Plot the WCSSE values"
"0","    plot(1:max_clusters, wcsse_values,"
"0","         type = ""b"", pch = 19, frame = FALSE, "
"0","         xlab = ""Number of clusters (K)"","
"0","         ylab = ""Total within-cluster sum of squares error (WCSSE)"")"
"0","  }"
"0","  "
"0","  # Determine the optimal number of clusters based on the criterion"
"0","  if (criterion == 'WCSSE') {"
"0","    optimal_clusters <- which.min(wcsse_values)"
"0","    message(""The optimal number of clusters based on WCSSE is "", optimal_clusters)"
"0","  } else {"
"0","    # Add additional criteria here"
"0","    message(""Invalid criterion specified."")"
"0","    return(NULL)"
"0","  }"
"0","  "
"0","  return(optimal_clusters)"
"0","}"
"0",""
"0","# Usage example"
"0","optimal_clusters <- Optimal_Clusters_KMeans(customer_data %>% "
"0","                                             select(""Age"", ""AnnualIncome"", ""SpendingScore""),"
"0","                                           max_clusters = 10, plot_clusters = TRUE, criterion = 'WCSSE')"
"0",""
