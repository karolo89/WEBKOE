---
title: "Market Segmentation Analysis"
author: "Orozco Karol M."
image: customer.jpg
date: "06-30-2023"
format:
  html:
    toc: true
    toc-location: right
    html-math-method: katex
    page-layout: full
execute: 
  warning: false
  message: false
categories: [R, Machine Learning, Prediction]
---

## Introduction

The purpose of this business report is to provide an overview of a project that analyzed a customer database from a mall. The project aimed to uncover underlying patterns in the customer base and group customers into segments, known as market segmentation. By understanding these segments, the marketing team can adopt a more targeted approach to reach consumers, and the mall can make informed strategic decisions to increase profits.

## Dataset and Methods Used

The dataset used in this analysis is a customer database from a mall, containing 200 observations with basic information such as age, gender, annual income, and spending score. The analysis was performed using the R programming language. Exploratory data analysis, descriptive statistics, data visualization, and unsupervised machine learning techniques (K-Means Clustering) were employed to achieve the project objectives.

## Project Highlights

The project yielded several important highlights and insights:

#### Load the required packages and dataset

```{r}
library(cluster) 
library(gridExtra)
library(grid)
library(skimr)
library(purrr)
library(NbClust)
library(factoextra)
library(ggplot2)
library(dplyr)

```

```{r}

customer_data <- read.csv("https://raw.githubusercontent.com/karolo89/WEBKOE/main/projects/MarketSegmentation/Mall_Customers.csv")

skim(customer_data)

```

```{r}

# Calculate gender percentages
gender_counts <- table(customer_data$Gender)
gender_pct <- round(gender_counts / sum(gender_counts) * 100)
gender_labels <- paste(names(gender_counts), gender_pct, "%", sep = " ")

# Set color palette
colors <- c("#336699", "#99CCFF")

# Create a data frame for the chart
gender_data <- data.frame(gender = names(gender_counts), count = gender_counts) %>%
  mutate(label = gender_labels)

# Create a bar plot to visualize the gender variable
gender_plot <- ggplot(gender_data, aes(x = gender, y = gender_counts, fill = gender)) +
  geom_bar(stat = "identity", width = 0.6, color = "white") +
  theme_minimal() +
  scale_fill_manual(values = colors) +
  labs(x = "", y = "Count", fill = "") +
  geom_text(aes(label = label), position = position_stack(vjust = 0.5)) +
  ggtitle("Gender Distribution") +
  theme(plot.title = element_text(size = 16, face = "bold", hjust = 0.5),
        axis.text = element_text(size = 12),
        axis.title = element_text(size = 14, face = "bold"),
        legend.position = "none")

# Plot age distribution with modified binwidth
age_plot <- ggplot(customer_data, aes(x = Age)) +
  geom_histogram(binwidth = 5, fill = "#336699", color = "white") +
  labs(x = "Age", y = "Frequency") +
  ggtitle("Age Distribution") +
  theme_minimal() +
  theme(plot.title = element_text(size = 16, face = "bold", hjust = 0.5),
        axis.text = element_text(size = 12),
        axis.title = element_text(size = 14, face = "bold"))

# Plot annual income distribution with modified binwidth
income_plot <- ggplot(customer_data, aes(x = Annual.Income..k..)) +
  geom_histogram(binwidth = 10, fill = "#336699", color = "white") +
  labs(x = "Annual Income (k)", y = "Frequency") +
  ggtitle("Annual Income Distribution") +
  theme_minimal() +
  theme(plot.title = element_text(size = 16, face = "bold", hjust = 0.5),
        axis.text = element_text(size = 12),
        axis.title = element_text(size = 14, face = "bold"))

# Plot spending score distribution with modified binwidth
score_plot <- ggplot(customer_data, aes(x = Spending.Score..1.100.)) +
  geom_histogram(binwidth = 5, fill = "#336699", color = "white") +
  labs(x = "Spending Score", y = "Frequency") +
  ggtitle("Spending Score Distribution") +
  theme_minimal() +
  theme(plot.title = element_text(size = 16, face = "bold", hjust = 0.5),
        axis.text = element_text(size = 12),
        axis.title = element_text(size = 14, face = "bold"))

# Display the plots
print(gender_plot)
print(age_plot)
print(income_plot)
print(score_plot)


```


## K-means Algorithm

```{r}
set.seed(123)
# function to calculate total intra-cluster sum of square 
iss <- function(k) {
  kmeans(customer_data[,3:5],k,iter.max=100,nstart=100,algorithm="Lloyd" )$tot.withinss
}

k.values <- 1:10


iss_values <- map_dbl(k.values, iss)

plot(k.values, iss_values,
     type="b", pch = 19, frame = FALSE, 
     xlab="Number of clusters K",
     ylab="Total intra-clusters sum of squares")
```

