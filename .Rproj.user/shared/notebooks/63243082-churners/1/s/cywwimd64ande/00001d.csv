"0",""
"0","prc = bind_cols(select(bank3, churn), as.data.frame(pr_bank$x)) %>%"
"0","  select(1:5) %>%"
"0","    rename(""rich_men"" = PC1, ""cheap_men"" = PC2, ""young_spenders"" = PC3, ""old_spenders""= PC4)"
"0",""
"0","#based on the graph below, ""young spenders"" and ""old spenders"" seem to be the most predictive of whether the customer will churn. "
"0",""
"0","# Pivot the data to long format"
"0","df_long <- prc %>%"
"0","  pivot_longer(cols = -churn, names_to = ""component"", values_to = ""loading"")"
"0",""
"0","# Convert churn to a factor variable"
"0","df_long$churn <- as.factor(df_long$churn)"
"0",""
"0","# Define custom colors"
"0","custom_colors <- c(""#E69F00"", ""#56B4E9"") # Replace with your preferred colors"
"0",""
"0","# Plot the density distribution with improved theme"
"0","ggplot(df_long, aes(loading, fill = churn)) +"
"0","  geom_density(alpha = 0.5) +"
"0","  facet_grid(. ~ component) +"
"0","  theme_minimal() +  # Set the overall theme to minimal"
"0","  labs(title = ""Density Distribution of Loading"","
"0","       x = ""Loading"", y = ""Density"") +  # Modify axis labels and title"
"0","  scale_fill_manual(values = custom_colors) +  # Use custom colors"
"0","  theme(plot.title = element_text(size = 16, face = ""bold""),  # Adjust title appearance"
"0","        axis.text = element_text(size = 12),  # Adjust axis text size"
"0","        legend.title = element_blank(),  # Hide legend title"
"0","        legend.position = ""bottom"")  # Position legend at the bottom"
