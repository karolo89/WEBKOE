"0","#with PCAs ""young spenders"" and ""old spenders"" "
"0",""
"0","fit_gbm1 <- train(churn ~ .,"
"0","             data = train, "
"0","             method = ""gbm"","
"0","             tuneLength = 4, "
"0","             preProcess = c(""center"",""scale""),"
"0","             metric = ""ROC"","
"0","             trControl = ctrl)"
"1","Iter   TrainDeviance   ValidDeviance   StepSize   Improve
"
"1","     1        0.8493             nan     0.1000    0.0167
"
"1","     2        0.8208             nan     0.1000    0.0132
"
"1","     3        0.7961             nan     0.1000    0.0128
"
"1","     4        0.7749             nan     0.1000    0.0096
"
"1","     5        0.7547             nan     0.1000    0.0106
"
"1","     6        0.7382             nan     0.1000    0.0081
"
"1","     7        0.7231             nan     0.1000    0.0073
"
"1","     8        0.7089             nan     0.1000    0.0063
"
"1","     9        0.6957             nan     0.1000    0.0058
"
"1","    10        0.6842             nan     0.1000    0.0057
"
"1","    20        0.6184             nan     0.1000    0.0024
"
"1","    40        0.5604             nan     0.1000    0.0007
"
"1","    60        0.5160             nan     0.1000    0.0011
"
"1","    80        0.4835             nan     0.1000    0.0005
"
"1","   100        0.4548             nan     0.1000    0.0009
"
"1","   120        0.4325             nan     0.1000    0.0006
"
"1","   140        0.4143             nan     0.1000    0.0002
"
"1","   160        0.3980             nan     0.1000    0.0001
"
"1","   180        0.3844             nan     0.1000    0.0001
"
"1","   200        0.3717             nan     0.1000   -0.0000
"
"1","
"
"1","Iter   TrainDeviance   ValidDeviance   StepSize   Improve
"
"1","     1        0.8127             nan     0.1000    0.0359
"
"1","     2        0.7726             nan     0.1000    0.0206
"
"1","     3        0.7400             nan     0.1000    0.0164
"
"1","     4        0.7122             nan     0.1000    0.0134
"
"1","     5        0.6906             nan     0.1000    0.0113
"
"1","     6        0.6676             nan     0.1000    0.0108
"
"1","     7        0.6520             nan     0.1000    0.0076
"
"1","     8        0.6413             nan     0.1000    0.0048
"
"1","     9        0.6313             nan     0.1000    0.0045
"
"1","    10        0.6185             nan     0.1000    0.0068
"
"1","    20        0.5407             nan     0.1000    0.0036
"
"1","    40        0.4341             nan     0.1000    0.0016
"
"1","    60        0.3817             nan     0.1000    0.0004
"
"1","    80        0.3468             nan     0.1000    0.0006
"
"1","   100        0.3256             nan     0.1000    0.0002
"
"1","   120        0.3109             nan     0.1000    0.0002
"
"1","   140        0.2993             nan     0.1000    0.0001
"
"1","   160        0.2890             nan     0.1000   -0.0001
"
"1","   180        0.2802             nan     0.1000   -0.0002
"
"1","   200        0.2725             nan     0.1000   -0.0001
"
"1","
"
"1","Iter   TrainDeviance   ValidDeviance   StepSize   Improve
"
"1","     1        0.8047             nan     0.1000    0.0366
"
"1","     2        0.7552             nan     0.1000    0.0238
"
"1","     3        0.7185             nan     0.1000    0.0169
"
"1","     4        0.6894             nan     0.1000    0.0137
"
"1","     5        0.6623             nan     0.1000    0.0123
"
"1","     6        0.6401             nan     0.1000    0.0112
"
"1","     7        0.6201             nan     0.1000    0.0099
"
"1","     8        0.6033             nan     0.1000    0.0078
"
"1","     9        0.5892             nan     0.1000    0.0069
"
"1","    10        0.5770             nan     0.1000    0.0057
"
"1","    20        0.4799             nan     0.1000    0.0033
"
"1","    40        0.3833             nan     0.1000    0.0003
"
"1","    60        0.3342             nan     0.1000    0.0003
"
"1","    80        0.3068             nan     0.1000    0.0003
"
"1","   100        0.2861             nan     0.1000   -0.0001
"
"1","   120        0.2729             nan     0.1000    0.0000
"
"1","   140        0.2631             nan     0.1000    0.0000
"
"1","   160        0.2537             nan     0.1000   -0.0003
"
"1","   180        0.2467             nan     0.1000   -0.0002
"
"1","   200        0.2394             nan     0.1000   -0.0001
"
"1","
"
"1","Iter   TrainDeviance   ValidDeviance   StepSize   Improve
"
"1","     1        0.8027             nan     0.1000    0.0384
"
"1","     2        0.7519             nan     0.1000    0.0245
"
"1","     3        0.7044             nan     0.1000    0.0214
"
"1","     4        0.6684             nan     0.1000    0.0175
"
"1","     5        0.6409             nan     0.1000    0.0132
"
"1","     6        0.6176             nan     0.1000    0.0095
"
"1","     7        0.5961             nan     0.1000    0.0098
"
"1","     8        0.5756             nan     0.1000    0.0103
"
"1","     9        0.5593             nan     0.1000    0.0075
"
"1","    10        0.5426             nan     0.1000    0.0076
"
"1","    20        0.4453             nan     0.1000    0.0024
"
"1","    40        0.3489             nan     0.1000    0.0011
"
"1","    60        0.3010             nan     0.1000    0.0009
"
"1","    80        0.2785             nan     0.1000   -0.0002
"
"1","   100        0.2637             nan     0.1000    0.0001
"
"1","   120        0.2525             nan     0.1000   -0.0001
"
"1","   140        0.2419             nan     0.1000    0.0001
"
"1","   160        0.2317             nan     0.1000   -0.0001
"
"1","   180        0.2240             nan     0.1000   -0.0000
"
"1","   200        0.2160             nan     0.1000    0.0001
"
"1","
"
"1","Iter   TrainDeviance   ValidDeviance   StepSize   Improve
"
"1","     1        0.8476             nan     0.1000    0.0157
"
"1","     2        0.8221             nan     0.1000    0.0119
"
"1","     3        0.7976             nan     0.1000    0.0115
"
"1","     4        0.7786             nan     0.1000    0.0091
"
"1","     5        0.7599             nan     0.1000    0.0085
"
"1","     6        0.7454             nan     0.1000    0.0071
"
"1","     7        0.7319             nan     0.1000    0.0068
"
"1","     8        0.7194             nan     0.1000    0.0056
"
"1","     9        0.7081             nan     0.1000    0.0050
"
"1","    10        0.6986             nan     0.1000    0.0045
"
"1","    20        0.6374             nan     0.1000    0.0025
"
"1","    40        0.5746             nan     0.1000    0.0009
"
"1","    60        0.5292             nan     0.1000    0.0006
"
"1","    80        0.4919             nan     0.1000    0.0006
"
"1","   100        0.4637             nan     0.1000    0.0005
"
"1","   120        0.4381             nan     0.1000    0.0008
"
"1","   140        0.4184             nan     0.1000    0.0003
"
"1","   160        0.4011             nan     0.1000    0.0001
"
"1","   180        0.3874             nan     0.1000   -0.0001
"
"1","   200        0.3748             nan     0.1000   -0.0000
"
"1","
"
"1","Iter   TrainDeviance   ValidDeviance   StepSize   Improve
"
"1","     1        0.8208             nan     0.1000    0.0302
"
"1","     2        0.7800             nan     0.1000    0.0202
"
"1","     3        0.7498             nan     0.1000    0.0150
"
"1","     4        0.7285             nan     0.1000    0.0106
"
"1","     5        0.7024             nan     0.1000    0.0126
"
"1","     6        0.6869             nan     0.1000    0.0075
"
"1","     7        0.6686             nan     0.1000    0.0091
"
"1","     8        0.6535             nan     0.1000    0.0075
"
"1","     9        0.6413             nan     0.1000    0.0063
"
"1","    10        0.6301             nan     0.1000    0.0054
"
"1","    20        0.5467             nan     0.1000    0.0028
"
"1","    40        0.4457             nan     0.1000    0.0015
"
"1","    60        0.3907             nan     0.1000    0.0008
"
"1","    80        0.3626             nan     0.1000    0.0004
"
"1","   100        0.3333             nan     0.1000    0.0011
"
"1","   120        0.3148             nan     0.1000    0.0006
"
"1","   140        0.3003             nan     0.1000   -0.0001
"
"1","   160        0.2913             nan     0.1000   -0.0001
"
"1","   180        0.2827             nan     0.1000    0.0001
"
"1","   200        0.2769             nan     0.1000   -0.0001
"
"1","
"
"1","Iter   TrainDeviance   ValidDeviance   StepSize   Improve
"
"1","     1        0.8113             nan     0.1000    0.0331
"
"1","     2        0.7683             nan     0.1000    0.0204
"
"1","     3        0.7329             nan     0.1000    0.0175
"
"1","     4        0.7034             nan     0.1000    0.0143
"
"1","     5        0.6737             nan     0.1000    0.0142
"
"1","     6        0.6503             nan     0.1000    0.0100
"
"1","     7        0.6311             nan     0.1000    0.0085
"
"1","     8        0.6151             nan     0.1000    0.0067
"
"1","     9        0.6007             nan     0.1000    0.0067
"
"1","    10        0.5893             nan     0.1000    0.0046
"
"1","    20        0.4784             nan     0.1000    0.0064
"
"1","    40        0.3864             nan     0.1000    0.0027
"
"1","    60        0.3359             nan     0.1000    0.0001
"
"1","    80        0.3104             nan     0.1000    0.0001
"
"1","   100        0.2926             nan     0.1000    0.0001
"
"1","   120        0.2805             nan     0.1000    0.0005
"
"1","   140        0.2683             nan     0.1000    0.0003
"
"1","   160        0.2582             nan     0.1000   -0.0001
"
"1","   180        0.2509             nan     0.1000   -0.0001
"
"1","   200        0.2451             nan     0.1000   -0.0002
"
"1","
"
"1","Iter   TrainDeviance   ValidDeviance   StepSize   Improve
"
"1","     1        0.8061             nan     0.1000    0.0355
"
"1","     2        0.7575             nan     0.1000    0.0232
"
"1","     3        0.7210             nan     0.1000    0.0180
"
"1","     4        0.6890             nan     0.1000    0.0149
"
"1","     5        0.6653             nan     0.1000    0.0106
"
"1","     6        0.6376             nan     0.1000    0.0124
"
"1","     7        0.6114             nan     0.1000    0.0115
"
"1","     8        0.5918             nan     0.1000    0.0092
"
"1","     9        0.5783             nan     0.1000    0.0058
"
"1","    10        0.5601             nan     0.1000    0.0091
"
"1","    20        0.4529             nan     0.1000    0.0025
"
"1","    40        0.3576             nan     0.1000    0.0010
"
"1","    60        0.3134             nan     0.1000    0.0003
"
"1","    80        0.2861             nan     0.1000   -0.0001
"
"1","   100        0.2729             nan     0.1000    0.0001
"
"1","   120        0.2605             nan     0.1000    0.0003
"
"1","   140        0.2486             nan     0.1000   -0.0003
"
"1","   160        0.2396             nan     0.1000   -0.0001
"
"1","   180        0.2303             nan     0.1000   -0.0001
"
"1","   200        0.2233             nan     0.1000   -0.0001
"
"1","
"
"1","Iter   TrainDeviance   ValidDeviance   StepSize   Improve
"
"1","     1        0.8480             nan     0.1000    0.0165
"
"1","     2        0.8224             nan     0.1000    0.0112
"
"1","     3        0.7985             nan     0.1000    0.0123
"
"1","     4        0.7789             nan     0.1000    0.0093
"
"1","     5        0.7618             nan     0.1000    0.0076
"
"1","     6        0.7453             nan     0.1000    0.0081
"
"1","     7        0.7329             nan     0.1000    0.0063
"
"1","     8        0.7212             nan     0.1000    0.0057
"
"1","     9        0.7100             nan     0.1000    0.0053
"
"1","    10        0.7003             nan     0.1000    0.0050
"
"1","    20        0.6402             nan     0.1000    0.0027
"
"1","    40        0.5782             nan     0.1000    0.0007
"
"1","    60        0.5286             nan     0.1000    0.0007
"
"1","    80        0.4941             nan     0.1000    0.0007
"
"1","   100        0.4644             nan     0.1000    0.0003
"
"1","   120        0.4399             nan     0.1000    0.0003
"
"1","   140        0.4187             nan     0.1000    0.0003
"
"1","   160        0.4020             nan     0.1000   -0.0001
"
"1","   180        0.3886             nan     0.1000    0.0002
"
"1","   200        0.3748             nan     0.1000    0.0001
"
"1","
"
"1","Iter   TrainDeviance   ValidDeviance   StepSize   Improve
"
"1","     1        0.8233             nan     0.1000    0.0290
"
"1","     2        0.7803             nan     0.1000    0.0202
"
"1","     3        0.7457             nan     0.1000    0.0174
"
"1","     4        0.7191             nan     0.1000    0.0121
"
"1","     5        0.6960             nan     0.1000    0.0110
"
"1","     6        0.6797             nan     0.1000    0.0076
"
"1","     7        0.6664             nan     0.1000    0.0072
"
"1","     8        0.6502             nan     0.1000    0.0077
"
"1","     9        0.6363             nan     0.1000    0.0061
"
"1","    10        0.6253             nan     0.1000    0.0049
"
"1","    20        0.5390             nan     0.1000    0.0017
"
"1","    40        0.4288             nan     0.1000    0.0015
"
"1","    60        0.3760             nan     0.1000    0.0015
"
"1","    80        0.3429             nan     0.1000    0.0009
"
"1","   100        0.3205             nan     0.1000    0.0001
"
"1","   120        0.3079             nan     0.1000   -0.0002
"
"1","   140        0.2934             nan     0.1000    0.0002
"
"1","   160        0.2833             nan     0.1000    0.0000
"
"1","   180        0.2748             nan     0.1000   -0.0000
"
"1","   200        0.2669             nan     0.1000   -0.0001
"
"1","
"
"1","Iter   TrainDeviance   ValidDeviance   StepSize   Improve
"
"1","     1        0.8097             nan     0.1000    0.0358
"
"1","     2        0.7629             nan     0.1000    0.0227
"
"1","     3        0.7273             nan     0.1000    0.0164
"
"1","     4        0.6969             nan     0.1000    0.0150
"
"1","     5        0.6708             nan     0.1000    0.0127
"
"1","     6        0.6492             nan     0.1000    0.0096
"
"1","     7        0.6323             nan     0.1000    0.0078
"
"1","     8        0.6165             nan     0.1000    0.0076
"
"1","     9        0.6015             nan     0.1000    0.0071
"
"1","    10        0.5813             nan     0.1000    0.0097
"
"1","    20        0.4813             nan     0.1000    0.0024
"
"1","    40        0.3772             nan     0.1000    0.0013
"
"1","    60        0.3301             nan     0.1000    0.0001
"
"1","    80        0.2986             nan     0.1000    0.0005
"
"1","   100        0.2810             nan     0.1000   -0.0000
"
"1","   120        0.2657             nan     0.1000   -0.0000
"
"1","   140        0.2554             nan     0.1000   -0.0002
"
"1","   160        0.2457             nan     0.1000   -0.0002
"
"1","   180        0.2386             nan     0.1000   -0.0002
"
"1","   200        0.2326             nan     0.1000   -0.0003
"
"1","
"
"1","Iter   TrainDeviance   ValidDeviance   StepSize   Improve
"
"1","     1        0.8074             nan     0.1000    0.0368
"
"1","     2        0.7563             nan     0.1000    0.0249
"
"1","     3        0.7169             nan     0.1000    0.0202
"
"1","     4        0.6832             nan     0.1000    0.0160
"
"1","     5        0.6460             nan     0.1000    0.0177
"
"1","     6        0.6212             nan     0.1000    0.0119
"
"1","     7        0.6041             nan     0.1000    0.0080
"
"1","     8        0.5839             nan     0.1000    0.0090
"
"1","     9        0.5657             nan     0.1000    0.0086
"
"1","    10        0.5475             nan     0.1000    0.0087
"
"1","    20        0.4472             nan     0.1000    0.0033
"
"1","    40        0.3552             nan     0.1000    0.0005
"
"1","    60        0.3057             nan     0.1000    0.0008
"
"1","    80        0.2813             nan     0.1000   -0.0001
"
"1","   100        0.2632             nan     0.1000   -0.0000
"
"1","   120        0.2459             nan     0.1000   -0.0002
"
"1","   140        0.2368             nan     0.1000   -0.0000
"
"1","   160        0.2282             nan     0.1000   -0.0001
"
"1","   180        0.2209             nan     0.1000   -0.0002
"
"1","   200        0.2135             nan     0.1000   -0.0005
"
"1","
"
"1","Iter   TrainDeviance   ValidDeviance   StepSize   Improve
"
"1","     1        0.8089             nan     0.1000    0.0368
"
"1","     2        0.7568             nan     0.1000    0.0246
"
"1","     3        0.7171             nan     0.1000    0.0190
"
"1","     4        0.6877             nan     0.1000    0.0135
"
"1","     5        0.6635             nan     0.1000    0.0116
"
"1","     6        0.6365             nan     0.1000    0.0127
"
"1","     7        0.6137             nan     0.1000    0.0105
"
"1","     8        0.5942             nan     0.1000    0.0097
"
"1","     9        0.5764             nan     0.1000    0.0084
"
"1","    10        0.5572             nan     0.1000    0.0097
"
"1","    20        0.4548             nan     0.1000    0.0030
"
"1","    40        0.3516             nan     0.1000    0.0010
"
"1","    60        0.3127             nan     0.1000    0.0002
"
"1","    80        0.2920             nan     0.1000    0.0002
"
"1","   100        0.2746             nan     0.1000   -0.0001
"
"1","   120        0.2632             nan     0.1000    0.0002
"
"1","   140        0.2528             nan     0.1000   -0.0002
"
"1","   160        0.2454             nan     0.1000   -0.0001
"
"1","   180        0.2390             nan     0.1000   -0.0003
"
"1","   200        0.2334             nan     0.1000   -0.0002
"
"1","
"
"0","confusionMatrix(predict(fit_gbm1, test),factor(test$churn))"
"1","Confusion Matrix and Statistics

"
"1","          Reference
"
"1","Prediction"
"1","   no"
"1","  yes"
"1","
       no "
"1"," 1654"
"1","   80"
"1","
       yes"
"1","   46"
"1","  245"
"1","
"
"1",""
"1","                         "
"1","                 "
"1","
"
"1","               Accuracy :"
"1"," 0.9378          "
"1","
"
"1","                 95% CI :"
"1"," (0.9264, 0.9479)"
"1","
"
"1","    No Information Rate :"
"1"," 0.8395          "
"1","
"
"1","    P-Value [Acc > NIR] :"
"1"," < 2.2e-16       "
"1","
"
"1","                         "
"1","                 "
"1","
"
"1","                  Kappa :"
"1"," 0.7589          "
"1","
"
"1","                         "
"1","                 "
"1","
"
"1"," Mcnemar's Test P-Value :"
"1"," 0.003283        "
"1","
"
"1","                         "
"1","                 "
"1","
"
"1","            Sensitivity :"
"1"," 0.9729          "
"1","
"
"1","            Specificity :"
"1"," 0.7538          "
"1","
"
"1","         Pos Pred Value :"
"1"," 0.9539          "
"1","
"
"1","         Neg Pred Value :"
"1"," 0.8419          "
"1","
"
"1","             Prevalence :"
"1"," 0.8395          "
"1","
"
"1","         Detection Rate :"
"1"," 0.8168          "
"1","
"
"1","   Detection Prevalence :"
"1"," 0.8563          "
"1","
"
"1","      Balanced Accuracy :"
"1"," 0.8634          "
"1","
"
"1","                         "
"1","                 "
"1","
"
"1","       'Positive' Class :"
"1"," no              "
"1","
"
"1","                         "
"1","                 "
"1","
"
"0","myRoc <- roc(test$churn, predict(fit_gbm1, test, type=""prob"")[,2])"
"2","Setting levels: control = no, case = yes
"
"2","Setting direction: controls < cases
"
"0","plot(myRoc)"
